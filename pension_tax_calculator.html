<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××—×©×‘×•×Ÿ ×”×˜×‘×•×ª ××¡ ×œ×—×™×¡×›×•×Ÿ ×¤× ×¡×™×•× ×™ 2025</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-right: 4px solid #667eea;
        }

        .section-title {
            font-size: 20px;
            color: #667eea;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        input[type="number"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        input[type="file"] {
            display: none;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-upload {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .upload-status {
            text-align: center;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            font-weight: bold;
            display: none;
        }

        .upload-status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .upload-status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .results {
            display: none;
            margin-top: 30px;
        }

        .result-box {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e0e0e0;
        }

        .result-box.highlight {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-color: #667eea;
        }

        .result-title {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }

        .result-item {
            padding: 10px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .result-label {
            font-weight: 600;
            color: #555;
        }

        .result-value {
            font-weight: bold;
            color: #333;
            font-size: 18px;
        }

        .result-value.success {
            color: #28a745;
        }

        .result-value.danger {
            color: #dc3545;
        }

        .explanation {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .explanation-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .explanation-text {
            color: #856404;
            line-height: 1.6;
            font-size: 14px;
        }

        .icon {
            display: inline-block;
            margin-left: 8px;
        }

        .big-number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 10px;
            margin: 20px 0;
        }

        .info-box {
            background: #e7f3ff;
            border: 1px solid #2196F3;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .info-box-title {
            font-weight: bold;
            color: #1565C0;
            margin-bottom: 8px;
        }

        .info-box-text {
            color: #1565C0;
            line-height: 1.6;
            font-size: 14px;
        }

        .warning-box {
            background: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .warning-title {
            font-weight: bold;
            color: #e65100;
            margin-bottom: 8px;
        }

        .warning-text {
            color: #e65100;
            line-height: 1.6;
            font-size: 14px;
        }

        .step {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-right: 3px solid #667eea;
        }

        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§® ××—×©×‘×•×Ÿ ×”×˜×‘×•×ª ××¡ ×œ×—×™×¡×›×•×Ÿ ×¤× ×¡×™×•× ×™</h1>
            <p>×©× ×ª ××¡ 2025 | ×—×™×©×•×‘ ××“×•×™×§ ×œ×¤×™ ×¤×§×•×“×ª ××¡ ×”×›× ×¡×”</p>
        </div>

        <div class="content">
            <div class="info-box">
                <div class="info-box-title">ğŸ’¡ ×œ××” ×”××—×©×‘×•×Ÿ ×”×–×”?</div>
                <div class="info-box-text">
                    ××—×©×‘×•×Ÿ ×–×” ×¢×•×–×¨ ×œ×š ×œ×—×©×‘ ××ª ×”×”×˜×‘×•×ª ×”××§×¡×™××œ×™×•×ª ×‘××¡ ×©××ª/×” ×–×›××™/×ª ×œ×”×Ÿ ×‘×’×™×Ÿ ×”×¤×§×“×•×ª ×¢×¦×××™×•×ª ×œ×—×™×¡×›×•×Ÿ ×¤× ×¡×™×•× ×™. ×”××—×©×‘×•×Ÿ ××ª××™× ×œ×©×›×™×¨×™× ×¢× ×©×›×¨ ×œ× ××‘×•×˜×— (×‘×•× ×•×¡×™×, ×“××™ ×”×‘×¨××”, × ×¡×™×¢×•×ª ×•×›×•').
                </div>
            </div>

            <div class="section">
                <div class="section-title">ğŸ“ ×”×–× ×ª × ×ª×•× ×™×</div>
                
                <!-- ×›×¤×ª×•×¨ ×˜×¢×™× ×ª × ×™×ª×•×— ××¡ -->
                <input type="file" id="htmlFileInput" accept=".html,.htm" style="display: none;">
                <button class="btn btn-upload" onclick="document.getElementById('htmlFileInput').click()">
                    ğŸ“„ ×˜×¢×Ÿ × ×™×ª×•×— ××¡
                </button>
                <div id="uploadStatus" class="upload-status"></div>
                
                <div class="input-group">
                    <label>×©×›×¨ ×‘×¨×•×˜×• ××‘×•×˜×— (×©× ×ª×™) â‚ª</label>
                    <input type="number" id="shacharMevutach" placeholder="×œ×“×•×’××”: 700000">
                </div>

                <div class="input-group">
                    <label>×©×›×¨ ×‘×¨×•×˜×• ×œ× ××‘×•×˜×— (×©× ×ª×™) â‚ª</label>
                    <input type="number" id="shacharLoMevutach" placeholder="×œ×“×•×’××”: 109407">
                </div>

                <div class="input-group">
                    <label>××¡×¤×¨ ×—×•×“×©×™ ×¢×‘×•×“×” ×‘×©× ×”</label>
                    <input type="number" id="months" value="12" min="1" max="12">
                </div>

                <div class="input-group">
                    <label>×”×¤×§×“×•×ª ×§×™×™××•×ª ×œ×¤× ×¡×™×” (×©× ×ª×™) â‚ª</label>
                    <input type="number" id="havkadotPensia" placeholder="×œ×“×•×’××”: 16122">
                </div>
                <div class="input-group">
                    <label>×”×¤×§×“×•×ª ×§×™×™××•×ª ×œ×‘×™×˜×•×— ×—×™×™× (×©× ×ª×™) â‚ª</label>
                    <input type="number" id="bituachChayim" placeholder="×œ×“×•×’××”: 398">
                </div>

                <div class="input-group">
                    <label>×’×™×œ</label>
                    <input type="number" id="age" placeholder="×œ×“×•×’××”: 52" min="18" max="120">
                </div>
                 <div class="input-group">
                    <label>×©×›×¨ ×œ× ××¢×‘×•×“×”  (×©× ×ª×™) â‚ª</label>
                    <input type="number" id="shacharLoMeAvoda" placeholder="×œ×“×•×’××”: 100000">
                </div>

                <button class="btn" onclick="calculate()">ğŸ” ×—×©×‘ ×”×˜×‘×•×ª ××¡</button>
            </div>

            <div id="results" class="results"></div>
        </div>
    </div>

    <script>
        // ============= ×¤×•× ×§×¦×™×•×ª ×˜×¢×™× ×ª HTML =============

document.getElementById('htmlFileInput').addEventListener('change', async function(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    const statusDiv = document.getElementById('uploadStatus');
    
    try {
        // ×§×¨×™××ª ×”×§×•×‘×¥ ×¢× ×§×™×“×•×“ windows-1255
        const arrayBuffer = await file.arrayBuffer();
        const decoder = new TextDecoder('windows-1255');
        const htmlContent = decoder.decode(arrayBuffer);
        
        const extractedData = parseHtmlFile(htmlContent);
        
        if (extractedData.success) {
            fillFormFields(extractedData);
            statusDiv.className = 'upload-status success';
            statusDiv.textContent = 'âœ… ×”× ×ª×•× ×™× × ×˜×¢× ×• ×‘×”×¦×œ×—×”! ×× × ×‘×“×•×§ ×•×¢×“×›×Ÿ ××ª ×”×’×™×œ.';
        } else {
            statusDiv.className = 'upload-status error';
            statusDiv.textContent = 'âŒ ×©×’×™××”: ' + extractedData.error;
        }
    } catch (error) {
        statusDiv.className = 'upload-status error';
        statusDiv.textContent = 'âŒ ×©×’×™××” ×‘×§×¨×™××ª ×”×§×•×‘×¥: ' + error.message;
    }
});

        function parseHtmlFile(htmlContent) {
    try {
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlContent, 'text/html');
        
        const result = {
            success: false,
            shacharMevutach: 0,
            shacharLoMevutach: 0,
            months: 0,
            havkadotPensia: 0,
            bituachChayim: 0,
            error: ''
        };

        console.log('=== ×”×ª×—×œ×ª × ×™×ª×•×— ×”×§×•×‘×¥ ===');
       

// 1. ×—×™×©×•×‘ ××¡×¤×¨ ×—×•×“×©×™× ××˜×‘×œ×ª "×™×—×™×“×•×ª ××¡"
const yehidotMasTable = findTableByPartialTitle(doc, 'h1', ['×™×—×™×“×•×ª ××¡']);

if (yehidotMasTable) {
    console.log('âœ… × ××¦××” ×˜×‘×œ×ª ×™×—×™×“×•×ª ××¡');
    
    const allRows = yehidotMasTable.querySelectorAll('tr');
    
    // ×§×— ××ª ×”×©×•×¨×” ×”×©× ×™×™×” (××™× ×“×§×¡ 1) - ×©× ×™×—×™×“×•×ª ×”××¡!
    if (allRows.length >= 2) {
        const dataRow = allRows[1]; // ×©×•×¨×” 1 ×‘××§×•× ×©×•×¨×” 0
        const cells = dataRow.querySelectorAll('td, th');
        let monthCount = 0;
        
        console.log('=== ×¡×¤×™×¨×ª ×—×•×“×©×™× ××”×©×•×¨×” ×”×©× ×™×™×” ===');
        
        for (let i = 0; i < cells.length; i++) {
            const cellText = cells[i].textContent.trim();
            const value = parseFloat(cellText);
            
            console.log(`×‘×•×“×§ ×ª× ${i}: "${cellText}" â†’ ××¡×¤×¨: ${value}`);
            
            if (!isNaN(value) && value > 0 && value <= 31) {
                monthCount++;
                console.log(`  âœ“ ×–×” ×™×—×™×“×ª ××¡! ×¡×”"×›: ${monthCount}`);
            } else {
                console.log(`  âœ— ×œ× ×™×—×™×“×ª ××¡ - ×¢×•×¦×¨`);
                break;
            }
        }
        
        if (monthCount > 0 && monthCount <= 12) {
            result.months = monthCount;
            console.log('âœ… ××¡×¤×¨ ×—×•×“×©×™× ×¡×•×¤×™:', monthCount);
        }
    }
} else {
    console.log('âŒ ×œ× × ××¦××” ×˜×‘×œ×ª ×™×—×™×“×•×ª ××¡');
}


// 2. ×—×™×œ×•×¥ ×©×›×¨ ××‘×•×˜×— - ×¨×§ ××˜×‘×œ×ª "× ×ª×•× ×™ ×¢×–×¨ ×œ×—×™×©×•×‘ ×”×”×˜×‘×•×ª"
console.log('××—×¤×© ×˜×‘×œ×ª × ×ª×•× ×™ ×¢×–×¨...');
const natuneyEzerTable = findTableAfterH3(doc, '× ×ª×•× ×™  ×¢×–×¨ ×œ×—×™×©×•×‘ ×”×”×˜×‘×•×ª');

if (natuneyEzerTable) {
    console.log('âœ… × ××¦××” ×˜×‘×œ×ª × ×ª×•× ×™ ×¢×–×¨');
    const rows = natuneyEzerTable.querySelectorAll('tr');
    
    rows.forEach((row, rowIndex) => {
        const cells = row.querySelectorAll('th, td');
        
        cells.forEach((cell, cellIndex) => {
            const cellText = cell.textContent.trim();
            
            // ×©×›×¨ ×œ× ××‘×•×˜×— ×¤× ×¡×™×•× ×™×ª
            if (cellText.includes('×”×›× ×¡×ª ×¢×‘×•×“×” ×œ×') && cellText.includes('××‘×•×˜×—×ª ×¤× ×¡×™×•× ×™×ª')) {
                const nextRow = rows[rowIndex + 1];
                if (nextRow) {
                    const nextCells = nextRow.querySelectorAll('th, td');
                    if (nextCells[cellIndex]) {
                        const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                        if (!isNaN(value) && value > 0) {
                            result.shacharLoMevutach = value;
                            console.log('âœ… ×©×›×¨ ×œ× ××‘×•×˜×—:', value);
                        }
                    }
                }
            }
             // ×©×›×¨ ×œ× ××¢×‘×•×“×”
            if (cellText.includes('×”×›× ×¡×” ××–×›×”') && cellText.includes('××‘×•×˜×—×ª ×œ× ××¢×‘×•×“×”')) {
                const nextRow = rows[rowIndex + 1];
                if (nextRow) {
                    const nextCells = nextRow.querySelectorAll('th, td');
                    if (nextCells[cellIndex]) {
                        const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                        if (!isNaN(value) && value > 0) {
                            result.shacharLoMeAvoda = value;
                            console.log('×”×›× ×¡×” ×œ× ××¢×‘×•×“×”:', value);
                        }
                    }
                }
            }
            
            // ×”×›× ×¡×” ×¤× ×¡×™×” ×”×•× ×™ ×¢×“ ×ª×§×¨×”
            if (cellText === '×”×›× ×¡×” ×¤× ×¡×™×” ×”×•× ×™ ×¢×“ ×ª×§×¨×”') {
                const nextRow = rows[rowIndex + 1];
                if (nextRow) {
                    const nextCells = nextRow.querySelectorAll('th, td');
                    if (nextCells[cellIndex]) {
                        const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                        if (!isNaN(value) && value > 0) {
                            result.shacharMevutach += value;
                            console.log('âœ… ×¤× ×¡×™×” ×”×•× ×™:', value);
                        }
                    }
                }
            }
            
            // ×”×›× ×¡×” ×œ×§×¦×‘×” ×œ× ××§×™×¤×” ×¢×“ ×ª×§×¨×”
                    if (cellText === '×”×›× ×¡×” ×œ×§×¦×‘×” ×œ× ××§×™×¤×” ×¢×“ ×ª×§×¨×”') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.shacharMevutach += value;
                                    console.log('âœ… ×§×¦×‘×” ×œ× ××§×™×¤×”:', value);
                                }
                            }
                        }
                    }
                    
                    // ×”×›× ×¡×” ×œ×§×¦×‘×” ×¢×“ ×ª×§×¨×”
                    if (cellText === '×”×›× ×¡×” ×œ×§×¦×‘×” ×¢×“ ×ª×§×¨×” (×¢×“ 2009 ×¨×§ ××§×™×¤×”)') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.shacharMevutach += value;
                                    console.log('âœ… ×§×¦×‘×” ×¢×“ ×ª×§×¨×”:', value);
                                }
                            }
                        }
                    }
                    
                    // ×‘×¨×•×˜×• ×¤× ×¡×™×” ×ª×§×¦×™×‘×™×ª
                    if (cellText === '×‘×¨×•×˜×• ×¤× ×¡×™×” ×ª×§×¦×™×‘×™×ª') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.shacharMevutach += value;
                                    console.log('âœ… ×¤× ×¡×™×” ×ª×§×¦×™×‘×™×ª:', value);
                                }
                            }
                        }
                    }
        });
    });
}


        // 3. ×—×™×œ×•×¥ × ×ª×•× ×™× ××›×œ ×”×˜×‘×œ××•×ª
        const allTables = doc.querySelectorAll('table');
        console.log('×¡×”"×› ×˜×‘×œ××•×ª ×‘×§×•×‘×¥:', allTables.length);
        
        allTables.forEach((table, tableIndex) => {
            const rows = table.querySelectorAll('tr');
            
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('th, td');
                
                // ×¢×‘×•×¨ ×¢×œ ×›×œ ×ª× ×•×‘×“×•×§ ××ª ×”×ª×•×›×Ÿ
                cells.forEach((cell, cellIndex) => {
                    const cellText = cell.textContent.trim();
                      
                    // ×—×¡×›×•×Ÿ ×‘×™×˜×•×— ×—×™×™×
                    if (cellText === '×—×¡×›×•×Ÿ ×‘×˜×•×— ×—×™×™×') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.bituachChayim = value;
                                    console.log('âœ… ×‘×™×˜×•×— ×—×™×™×:', value);
                                }
                            }
                        }
                    }
                    
                    // ×—×¡×›×•×Ÿ ×¤× ×¡×™×” ×”×•× ×™- ×©×›×™×¨
                    if (cellText === '×—×¡×›×•×Ÿ ×¤× ×¡×™×” ×”×•× ×™- ×©×›×™×¨') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.havkadotPensia += value;
                                    console.log('âœ… ×¤× ×¡×™×” ×”×•× ×™ ×©×›×™×¨:', value);
                                }
                            }
                        }
                    }
                    
                    // ×—×¡×›×•×Ÿ ×§×¦×‘×” ×œ× ××§×™×¤×” - ×©×›×™×¨
                    if (cellText === '×—×¡×›×•×Ÿ ×§×¦×‘×” ×œ× ××§×™×¤×” - ×©×›×™×¨') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.havkadotPensia += value;
                                    console.log('âœ… ×§×¦×‘×” ×œ× ××§×™×¤×” ×©×›×™×¨:', value);
                                }
                            }
                        }
                    }
                    
                    // ×—×¡×›×•×Ÿ ×œ×§×¦×‘×” ××§×™×¤×”- ×©×›×™×¨
                    if (cellText === '×—×¡×›×•×Ÿ ×œ×§×¦×‘×” ××§×™×¤×”- ×©×›×™×¨') {
                        const nextRow = rows[rowIndex + 1];
                        if (nextRow) {
                            const nextCells = nextRow.querySelectorAll('th, td');
                            if (nextCells[cellIndex]) {
                                const value = parseFloat(nextCells[cellIndex].textContent.trim().replace(/,/g, ''));
                                if (!isNaN(value) && value > 0) {
                                    result.havkadotPensia += value;
                                    console.log('âœ… ×§×¦×‘×” ××§×™×¤×” ×©×›×™×¨:', value);
                                }
                            }
                        }
                    }
                });
            });
        });

        console.log('=== ×ª×•×¦××•×ª ×¡×•×¤×™×•×ª ===');
        console.log('×©×›×¨ ××‘×•×˜×—:', result.shacharMevutach);
        console.log('×©×›×¨ ×œ× ××‘×•×˜×—:', result.shacharLoMevutach);
        console.log('×”×¤×§×“×•×ª ×¤× ×¡×™×”:', result.havkadotPensia);
        console.log('×‘×™×˜×•×— ×—×™×™×:', result.bituachChayim);
        console.log('×—×•×“×©×™×:', result.months);
        console.log('×—×•×“×©×™×:', result.shacharLoMeAvoda);

        // ×‘×“×™×§×” ×©× ××¦× ×œ×¤×—×•×ª ×—×œ×§ ××”× ×ª×•× ×™×
        if (result.shacharMevutach > 0 || result.shacharLoMevutach > 0 || result.havkadotPensia > 0) {
            result.success = true;
        } else {
            result.error = '×œ× × ××¦××• × ×ª×•× ×™× ×‘×§×•×‘×¥ ×”-HTML. ×™×™×ª×›×Ÿ ×©××‘× ×” ×”×§×•×‘×¥ ×©×•× ×” ××”×¦×¤×•×™.';
        }

        return result;
        
    } catch (error) {
        console.error('×©×’×™××” ×‘×¤×¨×¡×•×¨:', error);
        return {
            success: false,
            error: '×©×’×™××” ×‘×¤×¨×¡×•×¨ ×”×§×•×‘×¥: ' + error.message
        };
    }
}
function findTableAfterH3(doc, title) {
    const headers = doc.querySelectorAll('h3');
    for (let header of headers) {
        if (header.textContent.includes(title)) {
            let nextElement = header.nextElementSibling;
            while (nextElement) {
                if (nextElement.tagName === 'DIV' && nextElement.classList.contains('table-block')) {
                    return nextElement.querySelector('table');
                }
                if (nextElement.tagName === 'TABLE') {
                    return nextElement;
                }
                if (nextElement.tagName === 'H1' || nextElement.tagName === 'H3') {
                    break;
                }
                nextElement = nextElement.nextElementSibling;
            }
        }
    }
    return null;
}
function findTableByPartialTitle(doc, headerTag, keywords) {
    const headers = doc.querySelectorAll(headerTag);
    for (let header of headers) {
        const headerText = header.textContent;
        const matchesAny = keywords.some(keyword => headerText.includes(keyword));
        
        if (matchesAny) {
            let nextElement = header.nextElementSibling;
            while (nextElement) {
                if (nextElement.tagName === 'DIV' && nextElement.classList.contains('table-block')) {
                    return nextElement.querySelector('table');
                }
                if (nextElement.tagName === 'TABLE') {
                    return nextElement;
                }
                if (nextElement.tagName === 'H1' || nextElement.tagName === 'H3') {
                    break;
                }
                nextElement = nextElement.nextElementSibling;
            }
        }
    }
    return null;
}

function fillFormFields(data) {
    if (data.shacharMevutach > 0) {
        document.getElementById('shacharMevutach').value = Math.round(data.shacharMevutach);
    }
    if (data.shacharLoMevutach > 0) {
        document.getElementById('shacharLoMevutach').value = Math.round(data.shacharLoMevutach);
    }
    if (data.months > 0) {
        document.getElementById('months').value = data.months;
    }
    if (data.havkadotPensia > 0) {
        document.getElementById('havkadotPensia').value = Math.round(data.havkadotPensia);
    }
    if (data.bituachChayim > 0) {
        document.getElementById('bituachChayim').value = Math.round(data.bituachChayim);
    }
    if (data.shacharLoMeAvoda > 0) {
        document.getElementById('shacharLoMeAvoda').value = Math.round(data.shacharLoMeAvoda);
    }
}
        // ============= ×ª×§×¨×•×ª ×œ×©× ×ª 2025 - × ×™×ª×Ÿ ×œ×¢×“×›×Ÿ ×›×œ ×©× ×” =============
        const TAKROT_2025 = {
            //×ª×§×¨×ª ×”×¡×›×•× ×œ×–×™×›×•×™ ×‘×¢×“ ×“××™ ×‘×™×˜×•×—  ×•×ª×’×’××•×œ×™× 45 × (×“)
            tikraLeZukui1 :189,
            // ×ª×§×¨×ª ×”×¡×›×•× ×œ×–×™×›×•×™ ×‘×¢×“ ×“××™ ×‘×™×˜×•×— ×•×ª×’××•×œ×™× 45 × (×”) (2)
            tikraLeZukui1 :19400,
            //×”×›× ×¡×” ××–×›×” ×œ×¤×™ ×¡×¢×™×£ 47(×)(1)
            hachnasaMezaka :9700,
            //×”×›× ×¡×” ××–×›×” ×œ×¤×™ ×¡×¢×™×£ 47(×)(2)
            hachnasaMezaka2 :13700,
            // ×¡×£ ×¢××™×ª ××•×˜×‘ ×©× ×ª×™ (16% ××”×©×›×¨ ×”×××•×¦×¢ ×‘××©×§)
            amitMutavShanati: 25566.72,
            
            // ×ª×§×¨×ª ×©×›×¨ ××‘×•×˜×— ×—×•×“×©×™ ×œ×–×›××•×ª ×œ×¡×¢×™×£ 47 (× ×™×›×•×™)
            shacharMevutachMaxLeSe47: 24250,
            
            // ×ª×§×¨×ª ×–×™×›×•×™ ××§×¡×™××œ×™×ª ×œ×¢××™×ª ××•×˜×‘
            zikuiMaxAmitMutav: 11640,
            
            // ×ª×§×¨×ª ×–×™×›×•×™ ××§×¡×™××œ×™×ª ×œ×¢××™×ª ×œ× ××•×˜×‘
            zikuiMaxLoMutav: 16440,
            
            // ×ª×§×¨×ª × ×™×›×•×™ ××§×¡×™××œ×™×ª
            nikuiMax: 25608,
            
            // ×©×™×¢×•×¨ ×–×™×›×•×™
            zikuiRate: 0.35,
            
            // ×©×™×¢×•×¨ × ×™×›×•×™ ×¨×’×™×œ
            nikuiRateNormal: 0.11,
            
            // ×©×™×¢×•×¨ × ×™×›×•×™ ××¢×œ ×’×™×œ 50
            nikuiRateAge50: 0.165,
            
            // ×”×›× ×¡×” ××–×›×” ×œ×¡×¢×™×£ 47
            haknasaMezakeSe47: 116400
        };

        function formatNumber(num) {
            return num.toLocaleString('he-IL', {minimumFractionDigits: 0, maximumFractionDigits: 0});
        }

        function calculate() {
            // ×§×¨×™××ª ×¢×¨×›×™×
            const shacharMevutach = parseFloat(document.getElementById('shacharMevutach').value) || 0;
            const shacharLoMeAvoda = parseFloat(document.getElementById('shacharLoMeAvoda').value) || 0;
            const shacharLoMevutach = parseFloat(document.getElementById('shacharLoMevutach').value) || 0;
            const months = parseInt(document.getElementById('months').value) || 12;
            const havkadotPensia = parseFloat(document.getElementById('havkadotPensia').value) || 0;
            const havkadotBituachChayim = parseFloat(document.getElementById('bituachChayim').value) || 0;
           // const havkadotKayamot = havkadotPensia + havkadotBituachChayim;
            const age = parseInt(document.getElementById('age').value) || 0;
             
   // ×—×™×©×•×‘×™×
            const shacharMevutachChodshi = shacharMevutach / months;
            const amitMutavYachasi = (TAKROT_2025.amitMutavShanati / 12) * months;
            const isAmitMutav = havkadotPensia >= amitMutavYachasi;
            const missingToAmitMutav = Math.max(0, amitMutavYachasi - havkadotPensia);
            const hachnasaMezaka=TAKROT_2025.hachnasaMezaka;
            const hachnasaMezakaShnati = TAKROT_2025.hachnasaMezaka * months;
            const hachnasaMezaka2=TAKROT_2025.hachnasaMezaka2;
           
// ========== ×—×™×©×•×‘ ×–×™×›×•×™ ×¡×¢×™×£ 45× ==========

// 1. ×‘×™×˜×•×— ×—×™×™× - ×–×™×›×•×™ ×¢×œ ××” ×©×›×‘×¨ ×”×¤×§×™×“
const bituachChayimShalem = havkadotBituachChayim;
const zikuiBituachChayim = havkadotBituachChayim * 0.25;

// 2. ×¤× ×¡×™×” ××”×›× ×¡×” ××‘×•×˜×—×ª - ×–×™×›×•×™ ×¢×œ ××” ×©×›×‘×¨ ×”×¤×§×™×“
let pensiaMevutachet = shacharMevutach;
let takratPensiaMevutachet = 0;
let sumMazke_PensiaMevutachet = 0;
let zikuiPensiaMevutachet = 0;

if (shacharMevutach > 0) {
    takratPensiaMevutachet =     hachnasaMezakaShnati * 0.07; 

    sumMazke_PensiaMevutachet = Math.min(pensiaMevutachet, takratPensiaMevutachet);
    zikuiPensiaMevutachet = sumMazke_PensiaMevutachet * 0.35;
}

// 3. ×”×›× ×¡×” ×œ× ××‘×•×˜×—×ª - ×”×¤×§×“×” ×¤×•×˜× ×¦×™××œ×™×ª
let takratPensiaLoMevutachet = 0;
let takratPensiaLoMevutachetBasis = 0;
let zikuiPotencialiLoMevutach = 0;
let takratMaksimalit =0;
            

if (shacharLoMevutach > 0) {
    if (isAmitMutav) {
        // ×¢××™×ª ××•×˜×‘ - ×—×©×‘ ×ª×§×¨×” ×–××™× ×”
        const takra5Percent = shacharLoMevutach * 0.05;
        const takraMax = TAKROT_2025.hachnasaMezaka * 2 * months; 
        const nikui = Math.min(TAKROT_2025.hachnasaMezaka * months, shacharMevutach);
        const takratMaksimalit = (takraMax - nikui)*0.05;
        
        takratPensiaLoMevutachet = Math.max(0,Math.min(takra5Percent, takratMaksimalit)-havkadotBituachChayim);
       zikuiPotencialiLoMevutach = takratPensiaLoMevutachet * 0.35;
       takratPensiaLoMevutachetBasis =takratPensiaLoMevutachet/0.05
    } else {
        // ×œ× ×¢××™×ª ××•×˜×‘ - ×—×©×‘ ×›××” ×—×¡×¨ + ×ª×§×¨×” ×× ×™×”×¤×•×š
        takratPensiaLoMevutachet = missingToAmitMutav; // ×›××” ×—×¡×¨ ×œ×”×¤×•×š ×œ×¢××™×ª ××•×˜×‘
        
        // ×× ×™×”×¤×•×š ×œ×¢××™×ª ××•×˜×‘, ×™×•×›×œ ×œ×”×¤×§×™×“:
         const takra5Percent = shacharLoMevutach * 0.05;
        const takraMax = TAKROT_2025.hachnasaMezaka * 2 * months; 
        const nikui = Math.min(TAKROT_2025.hachnasaMezaka * months, shacharMevutach);
        const takratMaksimalit = (takraMax - nikui)*0.05;
        
        takratPensiaLoMevutachet = Math.max(0,Math.min(takra5Percent, takratMaksimalit)-havkadotBituachChayim);
        zikuiPotencialiLoMevutach = takratPensiaLoMevutachet * 0.35;
        takratPensiaLoMevutachetBasis =takratPensiaLoMevutachet/0.05
   }
}

// 4. ×¡×”"×› ×–×™×›×•×™ ×¢×œ ××” ×©×›×‘×¨ ×”×¤×§×™×“
const totalZikui45a = zikuiBituachChayim + zikuiPensiaMevutachet+zikuiPotencialiLoMevutach;

 // 5.×–×™×›×•×™ ×‘×’×™×Ÿ ×”×›× ×¡×” ×œ× ××¢×‘×•×“×”
const takratshacharLoMeAvoda =  hachnasaMezaka2*months;         
let shacharLoMeAvodaBefoal=shacharLoMeAvoda;            
let zikuishacharLoMeAvoda = 0;

if (shacharLoMeAvoda > 0) {
    takratshacharLoMeAvoda =Math.min(shacharLoMeAvodaBefoal,takratshacharLoMeAvoda);
    zikuishacharLoMeAvoda = takratshacharLoMeAvoda * 0.35*0.05;
}


// 6. ×–×™×›×•×™ ×¤×•×˜× ×¦×™××œ×™ × ×•×¡×£
//const zikuiPotenciali = zikuiPotencialiLoMevutach;
            
            // ×‘×“×™×§×ª ×–×›××•×ª ×œ×¡×¢×™×£ 47 (× ×™×›×•×™)
            const zikaiLeSe47 = shacharMevutachChodshi <= TAKROT_2025.shacharMevutachMaxLeSe47;

            // ×—×™×©×•×‘ ×–×™×›×•×™
            const maxZikuiTakra = isAmitMutav ? TAKROT_2025.zikuiMaxAmitMutav : TAKROT_2025.zikuiMaxLoMutav;
            const zikui5Percent = shacharLoMevutach * 0.05;
            const zikuiFinal = Math.min(zikui5Percent, maxZikuiTakra);
            const zikuiTaxBenefit = zikuiFinal * TAKROT_2025.zikuiRate;

            // ×—×™×©×•×‘ × ×™×›×•×™ (×× ×–×›××™)
            let nikuiFinal = 0;
            let nikuiTaxBenefit47 = 0;
            let nikuiTaxBenefit35 = 0;
            
            if (zikaiLeSe47) {
                const nikuiRate = age >= 50 ? TAKROT_2025.nikuiRateAge50 : TAKROT_2025.nikuiRateNormal;
                const nikuiPercent = shacharLoMevutach * nikuiRate;
                nikuiFinal = Math.min(nikuiPercent, TAKROT_2025.nikuiMax);
                nikuiTaxBenefit47 = nikuiFinal * 0.47;
                nikuiTaxBenefit35 = nikuiFinal * 0.35;
            }
displayResults({
    shacharMevutach,
    shacharLoMevutach,
    shacharMevutachChodshi,
    months,
    age,
    havkadotPensia,
    havkadotBituachChayim,
    isAmitMutav,
    amitMutavYachasi,
    missingToAmitMutav,
    zikaiLeSe47,
    zikuiFinal,
    zikuiTaxBenefit,
    nikuiFinal,
    nikuiTaxBenefit47,
    nikuiTaxBenefit35,
    bituachChayimShalem,
    zikuiBituachChayim,
    pensiaMevutachet,
    takratPensiaMevutachet,
    sumMazke_PensiaMevutachet,
    zikuiPensiaMevutachet,
    shacharLoMevutach,
    takratMaksimalit,
    takratPensiaLoMevutachet,
    zikuiPotencialiLoMevutach,
    totalZikui45a,
    shacharLoMeAvoda,
    shacharLoMeAvodaBefoal,
    takratshacharLoMeAvoda,
    zikuishacharLoMeAvoda,
    takratPensiaLoMevutachetBasis
});
        }

        function displayResults(data) {
            const resultsDiv = document.getElementById('results');
            
            let html = '<div class="result-box highlight">';
            html += '<div class="result-title">ğŸ“Š ×¡×™×›×•× ××¦×‘×š</div>';
            html += `<div class="result-item">
                <span class="result-label">×©×›×¨ ×‘×¨×•×˜×• ××‘×•×˜×— (×—×•×“×©×™)</span>
                <span class="result-value">${formatNumber(data.shacharMevutachChodshi)} â‚ª</span>
            </div>`;
            html += `<div class="result-item">
                <span class="result-label">×©×›×¨ ×œ× ××‘×•×˜×— (×©× ×ª×™)</span>
                <span class="result-value">${formatNumber(data.shacharLoMevutach)} â‚ª</span>
            </div>`;
            html += `<div class="result-item">
                <span class="result-label">××¡×¤×¨ ×—×•×“×©×™×</span>
                <span class="result-value">${data.months}</span>
            </div>`;
            html += `<div class="result-item">
                <span class="result-label">×’×™×œ</span>
                <span class="result-value">${data.age}</span>
            </div>`;
            html += '</div>';
         html += `<div class="result-item">
                <span class="result-label">×”×›× ×¡×” ×œ× ××¢×‘×•×“×” (×©× ×ª×™)</span>
                <span class="result-value">${formatNumber(data.shacharLoMeAvoda)} â‚ª</span>
            </div>`;    

            // ×‘×“×™×§×ª ×¢××™×ª ××•×˜×‘
            html += '<div class="result-box">';
            html += '<div class="result-title">ğŸ” ×‘×“×™×§×” #1: ×¢××™×ª ××•×˜×‘</div>';
            html += `<div class="result-item">
                <span class="result-label">×¡×£ ×¢××™×ª ××•×˜×‘ (${data.months} ×—×•×“×©×™×)</span>
                <span class="result-value">${formatNumber(data.amitMutavYachasi)} â‚ª</span>
            </div>`;
            html += `<div class="result-item">
                <span class="result-label">×”×¤×§×“×•×ª ×§×™×™××•×ª ×©×œ×š</span>
                <span class="result-value">${formatNumber(data.havkadotPensia)} â‚ª</span>
            </div>`;
            
            if (data.isAmitMutav) {
                html += `<div class="result-item">
                    <span class="result-label">×¡×˜×˜×•×¡</span>
                    <span class="result-value success">âœ… ×¢××™×ª ××•×˜×‘</span>
                </div>`;
                html += '<div class="explanation">';
                html += '<div class="explanation-title">ğŸ’¡ ××” ×–×” ××•××¨?</div>';
                html += '<div class="explanation-text">××ª/×” ×¢××™×ª/×” ××•×˜×‘/×ª! ×–×” ××•××¨ ×©××ª/×” ×–×›××™/×ª ×œ×ª×§×¨×•×ª ×’×‘×•×”×•×ª ×™×•×ª×¨ ×©×œ ×”×˜×‘×•×ª ××¡. ×”××©×š ×œ×§×¨×•× ×œ××˜×” ×›×“×™ ×œ×¨××•×ª ××ª ×”×”×˜×‘×•×ª ×”××œ××•×ª.</div>';
                html += '</div>';
            } else {
                html += `<div class="result-item">
                    <span class="result-label">×¡×˜×˜×•×¡</span>
                    <span class="result-value danger">âŒ ×œ× ×¢××™×ª ××•×˜×‘</span>
                </div>`;
                html += `<div class="result-item">
                    <span class="result-label">×—×¡×¨ ×œ×”×©×œ××”</span>
                    <span class="result-value danger">${formatNumber(data.missingToAmitMutav)} â‚ª</span>
                </div>`;
                html += '<div class="warning-box">';
                html += '<div class="warning-title">âš ï¸ ×—×©×•×‘!</div>';
                html += `<div class="warning-text">×›×“×™ ×œ×”×¤×•×š ×œ×¢××™×ª/×” ××•×˜×‘/×ª, ×¢×œ×™×š ×œ×”×¤×§×™×“ ×¢×•×“ <strong>${formatNumber(data.missingToAmitMutav)} â‚ª</strong>. ×–×” ×™××¤×©×¨ ×œ×š ×œ×§×‘×œ ×”×˜×‘×•×ª ××¡ ×’×‘×•×”×•×ª ×™×•×ª×¨.</div>`;
                html += '</div>';
            }
            html += '</div>';
            // ×”×˜×‘×•×ª ×–×™×›×•×™ ×¡×¢×™×£ 45×
html += '<div class="result-box highlight">';
html += '<div class="result-title">ğŸ’° ×–×™×›×•×™ ×××¡ ×œ×¤×™ ×¡×¢×™×£ 45×</div>';

// ×—×œ×§ 1: ×‘×™×˜×•×— ×—×™×™×
html += '<div class="result-title" style="font-size: 16px; margin-top: 15px;">ğŸ“‹ ×–×™×›×•×™ ×‘×¢×“ ×‘×™×˜×•×— ×—×™×™× - ×¡×¢×™×£ 45×(×)</div>';
html += `<div class="result-item">
    <span class="result-label">×¡×›×•× ×©×©×•×œ× ×œ×‘×™×˜×•×— ×—×™×™×</span>
    <span class="result-value">${formatNumber(data.bituachChayimShalem)} â‚ª</span>
</div>`;
html += `<div class="result-item">
    <span class="result-label">×©×™×¢×•×¨ ×–×™×›×•×™</span>
    <span class="result-value">25%</span>
</div>`;
html += `<div class="result-item" style="background: #e8f5e9;">
    <span class="result-label" style="font-weight: bold;">ğŸ’š ×–×™×›×•×™ ×××¡ - ×‘×™×˜×•×— ×—×™×™×</span>
    <span class="result-value success">${formatNumber(data.zikuiBituachChayim)} â‚ª</span>
</div>`;

// ×—×œ×§ 2: ×¤× ×¡×™×” - ×”×›× ×¡×” ××‘×•×˜×—×ª
if (data.shacharMevutach > 0) {
    html += '<div class="result-title" style="font-size: 16px; margin-top: 20px;">ğŸ“‹×–×™×›×•×™ ×‘×’×™×Ÿ ×”×›× ×¡×ª ×¢×‘×•×“×” ××‘×•×˜×—×ª 45×</div>';
    html += `<div class="result-item">
        <span class="result-label">×¡×›×•× ×©×©×•×œ× ×œ×¤× ×¡×™×” (××”×”×›× ×¡×” ×”××‘×•×˜×—×ª)</span>
        <span class="result-value">${formatNumber(data.pensiaMevutachet)} â‚ª</span>
    </div>`;
    html += `<div class="result-item">
        <span class="result-label">×ª×§×¨×” (7% ××”×”×›× ×¡×” ×”××–×›×” ×”××‘×•×˜×—×ª)</span>
        <span class="result-value">${formatNumber(data.takratPensiaMevutachet)} â‚ª</span>
    </div>`;
    html += `<div class="result-item">
        <span class="result-label">×¡×›×•× ×”××–×›×” ×‘×¤×•×¢×œ</span>
        <span class="result-value">${formatNumber(data.sumMazke_PensiaMevutachet)} â‚ª</span>
    </div>`;
    html += `<div class="result-item">
        <span class="result-label">×©×™×¢×•×¨ ×–×™×›×•×™</span>
        <span class="result-value">35%</span>
    </div>`;
    html += `<div class="result-item" style="background: #e8f5e9;">
        <span class="result-label" style="font-weight: bold;">ğŸ’š ×–×™×›×•×™ ×××¡ - ×¤× ×¡×™×” ××”×›× ×¡×” ××‘×•×˜×—×ª</span>
        <span class="result-value success">${formatNumber(data.zikuiPensiaMevutachet)} â‚ª</span>
    </div>`;
}

// ×—×œ×§ 3: ×¤× ×¡×™×” - ×”×›× ×¡×” ×œ× ××‘×•×˜×—×ª
if (data.shacharLoMevutach > 0) {
    html += '<div class="result-title" style="font-size: 16px; margin-top: 20px;">ğŸ“‹ ×–×™×›×•×™ ×‘×’×™×Ÿ ×”×›× ×¡×ª ×¢×‘×•×“×” ×œ× ××‘×•×˜×—×ª - ×¡×¢×™×£ 45×(×”)(2)(×‘)</div>';
    
    if (!data.isAmitMutav) {
        // ×× ×œ× ×¢××™×ª ××•×˜×‘ - ×”×•×“×¢×ª ××–×”×¨×”
        html += '<div class="warning-box" style="margin-bottom: 15px;">';
        html += '<div class="warning-title">âš ï¸ ×©×™× ×œ×‘</div>';
        html += '<div class="warning-text">';
        html += '<strong>×”×˜×‘×ª ×”××¡ ×‘×’×™×Ÿ ×”×›× ×¡×” ×œ× ××‘×•×˜×—×ª ××’×™×¢×” ×¨×§ ×œ×¢××™×ª ××•×˜×‘!</strong><br><br>';
        html += `×ª×•×›×œ ×œ×™×”× ×•×ª ××”×˜×‘×ª ××¡ ×–×• ×¨×§ ×‘×ª× ××™ ×©×ª×¤×§×™×“ ××™× ×™××•× ×©×œ <strong>${formatNumber(data.missingToAmitMutav)} â‚ª</strong> ×œ×§×•×¤×ª ×¤× ×¡×™×”, `;
        html += '×•×‘×›×š ×ª×”×¤×•×š ×œ×¢××™×ª ××•×˜×‘.<br><br>';
        html += '×œ××—×¨ ×©×ª×”×¤×•×š ×œ×¢××™×ª ××•×˜×‘, ×ª×•×›×œ ×œ×™×”× ×•×ª ××”×–×™×›×•×™ ×”××¤×•×¨×˜ ×œ×”×œ×Ÿ:';
        html += '</div>';
        html += '</div>';
    }
    
    html += `<div class="result-item">
        <span class="result-label">×”×›× ×¡×” ×œ× ××‘×•×˜×—×ª</span>
        <span class="result-value">${formatNumber(data.shacharLoMevutach)} â‚ª</span>
    </div>`;
    html += `<div class="result-item">
        <span class="result-label">×ª×§×¨×ª ×”×›× ×¡×” ×œ× ××‘×•×˜×—×ª</span>
        <span class="result-value">${formatNumber(data.takratPensiaLoMevutachetBasis)} â‚ª</span>
    </div>`;
    html += `<div class="result-item">
        <span class="result-label">×ª×§×¨×ª ×–×™×›×•×™: 5% ××”×›× ×¡×” ×œ× ××‘×•×˜×—×ª (××•×’×‘×œ ×‘×ª×§×¨×”)</span>
        <span class="result-value">${formatNumber(data.takratPensiaLoMevutachet)} â‚ª</span>
    </div>`;
    
    html += `<div class="result-item">
        <span class="result-label">×©×™×¢×•×¨ ×–×™×›×•×™</span>
        <span class="result-value">35%</span>
    </div>`;
    
    html += `<div class="result-item" style="background: ${data.isAmitMutav ? '#e8f5e9' : '#fff3e0'};">
        <span class="result-label" style="font-weight: bold;">${data.isAmitMutav ? 'ğŸ’š' : 'âš ï¸'} ×–×™×›×•×™ ×××¡ ×¤×•×˜× ×¦×™××œ×™ - ×‘×’×™×Ÿ ×”×›× ×¡×” ×œ× ××‘×•×˜×—×ª</span>
        <span class="result-value ${data.isAmitMutav ? 'success' : ''}">${formatNumber(data.zikuiPotencialiLoMevutach)} â‚ª</span>
    </div>`;      
}
            // ×—×œ×§ 5 ×–×™×›×•×™ ×‘×’×™×Ÿ ×©×›×¨ ×œ× ××¢×‘×•×“×” 
if (data.shacharLoMeAvoda > 0) {
    html += '<div class="result-title" style="font-size: 16px; margin-top: 20px;">ğŸ“‹×–×™×›×•×™ ×‘×’×™×Ÿ ×”×›× ×¡×” ×œ× ××¢×‘×•×“×” 45×</div>';
    html += `<div class="result-item">
        <span class="result-label">×”×›× ×¡×” ×œ× ××¢×‘×•×“×” </span>
        <span class="result-value">${formatNumber(data.shacharLoMeAvodaBefoal)} â‚ª</span>
    </div>`;
    html += `<div class="result-item">
        <span class="result-label">×ª×§×¨×ª ×©×›×¨ ×œ× ××¢×‘×•×“×” ×¡×¢×™×£ 47×2 </span>
        <span class="result-value">${formatNumber(data.takratshacharLoMeAvoda)} â‚ª</span>
    </div>`;
      html += `<div class="result-item">
        <span class="result-label">×©×™×¢×•×¨ ×–×™×›×•×™</span>
        <span class="result-value">35%</span>
    </div>`;
    html += `<div class="result-item" style="background: #e8f5e9;">
        <span class="result-label" style="font-weight: bold;">×–×™×›×•×™ ×‘×’×™×Ÿ ×ª×§×¨×ª ×”×›× ×¡×” ×œ× ××¢×‘×•×“×” ×›×¤×•×œ 5%</span>
        <span class="result-value success">${formatNumber(data.zikuishacharLoMeAvoda)} â‚ª</span>
    </div>`;
}
// ×¡×™×›×•× ×›×•×œ×œ
html += `<div class="big-number" style="background: linear-gradient(135deg, #28a74515 0%, #20c99715 100%); color: #28a745; margin-top: 20px;">
   âœ… ×¡×”"×› ×–×™×›×•×™ ×××¡ (×¡×¢×™×£ 45×): ${formatNumber(data.totalZikui45a)} â‚ª
</div>`;

html += '</div>';

            // ×‘×“×™×§×ª ×–×›××•×ª ×œ× ×™×›×•×™
            html += '<div class="result-box">';
            html += '<div class="result-title">ğŸ” ×‘×“×™×§×” #2: ×–×›××•×ª ×œ× ×™×›×•×™ (×¡×¢×™×£ 47)</div>';
            html += `<div class="result-item">
                <span class="result-label">×©×›×¨ ××‘×•×˜×— ×—×•×“×©×™ ×©×œ×š</span>
                <span class="result-value">${formatNumber(data.shacharMevutachChodshi)} â‚ª</span>
            </div>`;
            html += `<div class="result-item">
                <span class="result-label">×”×›× ×¡×” ××–×›×” ×œ×¤×™ ×¡×¢×™×£ 47 (×)(1)</span>
                <span class="result-value">${formatNumber(TAKROT_2025.hachnasaMezaka)} â‚ª</span>
            </div>`;
            html += `<div class="result-item">
                <span class="result-label">×¡×›×•× ×”×©×•×•×” ×œ×©×ª×™ ×¤×¢××™× ×•×—×¦×™ ×”×¡×›×•× ×”×××•×¨ ×‘×¤×¡×§×” (1) ×œ×”×’×“×¨×” "×”×›× ×¡×” ××–×›×”" ×œ×©× ×” -×ª×§×¨×ª ×©×›×¨ ×œ×¡×¢×™×£ 47</span>
                <span class="result-value">${formatNumber(TAKROT_2025.shacharMevutachMaxLeSe47)} â‚ª</span>
            </div>`;
            
            if (data.zikaiLeSe47) {
                html += `<div class="result-item">
                    <span class="result-label">×–×›××•×ª ×œ× ×™×›×•×™</span>
                    <span class="result-value success">âœ… ×›×Ÿ</span>
                </div>`;
                html += '<div class="info-box">';
                html += '<div class="info-box-title">ğŸ’¡ ××” ×–×” ××•××¨?</div>';
                html += '<div class="info-box-text">××ª/×” ×–×›××™/×ª ×’× ×œ× ×™×›×•×™ ×•×’× ×œ×–×™×›×•×™! ×–×” ××•××¨ ×©××ª/×” ×™×›×•×œ/×” ×œ×§×‘×œ ×”×˜×‘×•×ª ××¡ ×’× ×¢×œ × ×™×›×•×™ (×©××¤×—×™×ª ××ª ×”×”×›× ×¡×” ×”×—×™×™×‘×ª ×‘××¡) ×•×’× ×¢×œ ×–×™×›×•×™ (×”× ×—×” ×™×©×™×¨×” ×‘××¡).</div>';
                html += '</div>';
            } else {
                html += `<div class="result-item">
                    <span class="result-label">×–×›××•×ª ×œ× ×™×›×•×™</span>
                    <span class="result-value danger">âŒ ×œ×</span>
                </div>`;
                html += '<div class="warning-box">';
                html += '<div class="warning-title">âš ï¸ ×©×™×/×™ ×œ×‘</div>';
                html += `<div class="warning-text">×”×©×›×¨ ×”××‘×•×˜×— ×©×œ×š ×¢×•×‘×¨ ××ª ×”×ª×§×¨×” (${formatNumber(TAKROT_2025.shacharMevutachMaxLeSe47)} â‚ª), ×œ×›×Ÿ ××ª/×” ×–×›××™/×ª <strong>×¨×§ ×œ×–×™×›×•×™</strong> ×•×œ× ×œ× ×™×›×•×™.</div>`;
                html += '</div>';
            }
            html += '</div>';

            // ×”×˜×‘×•×ª × ×™×›×•×™ (×× ×–×›××™)
            if (data.zikaiLeSe47 && data.nikuiFinal > 0) {
                html += '<div class="result-box highlight">';
                html += '<div class="result-title">ğŸ’° ×”×˜×‘×ª × ×™×›×•×™ (×¡×¢×™×£ 47)</div>';
                
                const nikuiRate = data.age >= 50 ? TAKROT_2025.nikuiRateAge50 : TAKROT_2025.nikuiRateNormal;
                html += `<div class="result-item">
                    <span class="result-label">×©×™×¢×•×¨ × ×™×›×•×™ ${data.age >= 50 ? '(×’×™×œ 50+)' : ''}</span>
                    <span class="result-value">${(nikuiRate * 100)}%</span>
                </div>`;
                html += `<div class="result-item">
                    <span class="result-label">${(nikuiRate * 100)}% ××”×©×›×¨ ×”×œ× ××‘×•×˜×—</span>
                    <span class="result-value">${formatNumber(data.shacharLoMevutach * nikuiRate)} â‚ª</span>
                </div>`;
                html += `<div class="big-number">×”×¤×§×“×” ××§×¡×™××œ×™×ª: ${formatNumber(data.nikuiFinal)} â‚ª</div>`;
                html += `<div class="result-item">
                    <span class="result-label">×—×™×¡×›×•×Ÿ ×‘××¡ (××“×¨×’×ª 47%)</span>
                    <span class="result-value success">${formatNumber(data.nikuiTaxBenefit47)} â‚ª</span>
                </div>`;
                html += `<div class="result-item">
                    <span class="result-label">×—×™×¡×›×•×Ÿ ×‘××¡ (××“×¨×’×ª 35%)</span>
                    <span class="result-value success">${formatNumber(data.nikuiTaxBenefit35)} â‚ª</span>
                </div>`;
                
                html += '<div class="explanation">';
                html += '<div class="explanation-title">ğŸ’¡ ××” ×–×” × ×™×›×•×™?</div>';
                html += '<div class="explanation-text">';
                html += '<strong>× ×™×›×•×™ = ×”×•×¨×“×ª ×”×”×›× ×¡×” ×”×—×™×™×‘×ª ×‘××¡.</strong><br><br>';
                html += `×× ×ª×¤×§×™×“/×™ <strong>${formatNumber(data.nikuiFinal)} â‚ª</strong>, ×”×”×›× ×¡×” ×©×¢×œ×™×” ××—×©×‘×™× ××ª ×”××¡ ×ª×¤×—×ª ×‘×¡×›×•× ×”×–×”.<br><br>`;
                html += '×”×—×™×¡×›×•×Ÿ ×‘××¡ ×ª×œ×•×™ ×‘××“×¨×’×ª ×”××¡ ×©×œ×š:<br>';
                html += 'â€¢ ×× ××ª/×” ×‘××“×¨×’×ª 47%: ×—×•×¡×š/×ª ' + formatNumber(data.nikuiTaxBenefit47) + ' â‚ª<br>';
                html += 'â€¢ ×× ××ª/×” ×‘××“×¨×’×ª 35%: ×—×•×¡×š/×ª ' + formatNumber(data.nikuiTaxBenefit35) + ' â‚ª';
                html += '</div>';
                html += '</div>';
                html += '</div>';
            }

            // ×”×¡×‘×¨×™× × ×•×¡×¤×™×
            html += '<div class="result-box">';
            html += '<div class="result-title">ğŸ“š ×”×¡×‘×¨×™× ×—×©×•×‘×™×</div>';
            
            html += '<div class="explanation" style="background: #e8f5e9; border-color: #4caf50;">';
            html += '<div class="explanation-title" style="color: #2e7d32;">âœ… ××” ×–×” ×©×›×¨ ×œ× ××‘×•×˜×—?</div>';
            html += '<div class="explanation-text" style="color: #2e7d32;">';
            html += '×©×›×¨ ×œ× ××‘×•×˜×— ×”×•× ×”×—×œ×§ ××”×©×›×¨ ×©×¢×‘×•×¨×• ×”××¢×¡×™×§ <strong>×œ×</strong> ××¤×¨×™×© ×œ×¤× ×¡×™×”, ×›××•:<br>';
            html += 'â€¢ ×‘×•× ×•×¡×™× ×•×ª×•×¡×¤×•×ª<br>';
            html += 'â€¢ ×“××™ ×”×‘×¨××”<br>';
            html += 'â€¢ ×”×•×¦××•×ª × ×¡×™×¢×”<br>';
            html += 'â€¢ ×©×¢×•×ª × ×•×¡×¤×•×ª<br>';
            html += 'â€¢ ×©×™ ×œ×—×’<br>';
            html += '×¢×œ ×”×¡×›×•××™× ×”××œ×” ××¤×©×¨ ×œ×”×¤×§×™×“ ×‘×¢×¦××š ×•×œ×§×‘×œ ×”×˜×‘×•×ª ××¡!';
            html += '</div>';
            html += '</div>';

            html += '<div class="explanation" style="background: #fff3e0; border-color: #ff9800; margin-top: 15px;">';
            html += '<div class="explanation-title" style="color: #e65100;">âš–ï¸ ×”×‘×“×œ ×‘×™×Ÿ ×–×™×›×•×™ ×œ× ×™×›×•×™</div>';
            html += '<div class="explanation-text" style="color: #e65100;">';
            html += '<strong>×–×™×›×•×™ (×¡×¢×™×£ 45×):</strong><br>';
            html += 'â€¢ ×”× ×—×” ×™×©×™×¨×” ××”××¡<br>';
            html += 'â€¢ ×ª××™×“ 35% ××¡×›×•× ×”×”×¤×§×“×”<br>';
            html += 'â€¢ ×œ× ×ª×œ×•×™ ×‘××“×¨×’×ª ×”××¡<br><br>';
            html += '<strong>× ×™×›×•×™ (×¡×¢×™×£ 47):</strong><br>';
            html += 'â€¢ ××¤×—×™×ª ××ª ×”×”×›× ×¡×” ×”×—×™×™×‘×ª ×‘××¡<br>';
            html += 'â€¢ ×”×—×™×¡×›×•×Ÿ ×ª×œ×•×™ ×‘××“×¨×’×ª ×”××¡ ×©×œ×š<br>';
            html += 'â€¢ ×¨×§ ×œ××™ ×©×©×›×¨×• ×”××‘×•×˜×— × ××•×š ×-' + formatNumber(TAKROT_2025.shacharMevutachMaxLeSe47) + ' â‚ª ×œ×—×•×“×©';
            html += '</div>';
            html += '</div>';

            html += '<div class="explanation" style="background: #e3f2fd; border-color: #2196f3; margin-top: 15px;">';
            html += '<div class="explanation-title" style="color: #0d47a1;">ğŸ“ ××” ×–×” ×¢××™×ª ××•×˜×‘?</div>';
            html += '<div class="explanation-text" style="color: #0d47a1;">';
       html += '<strong>×”×’×“×¨×” ×œ×¤×™ ×¡×¢×™×£ 47(×)(7) ×œ×¤×§×•×“×ª ××¡ ×”×›× ×¡×”:</strong><br>';
html += '"×¢××™×ª ××•×˜×‘" â€“ ×™×—×™×“ ×©×”×¤×§×™×“ ×‘×©× ×ª ×”××¡ ×œ×¤× ×¡×™×” ×œ×¤×—×•×ª ';
html += '<strong>16% ××”×©×›×¨ ×”×××•×¦×¢ ×‘××©×§</strong>.<br><br>';

html += '<strong>×—×™×©×•×‘ ×œ×©× ×ª 2025:</strong><br>';
html += 'â€¢ ×”×©×›×¨ ×”×××•×¦×¢ ×‘××©×§: 13,316 â‚ª/×—×•×“×© (159,792 â‚ª/×©× ×”)<br>';
html += 'â€¢ 16% ××”×©×›×¨ ×”×××•×¦×¢: 159,792 Ã— 16% = <strong>' + formatNumber(TAKROT_2025.amitMutavShanati) + ' â‚ª</strong><br><br>';

html += '<strong>ğŸ’¡ ×œ×ª×§×•×¤×•×ª ×¢×‘×•×“×” ×—×œ×§×™×•×ª:</strong><br>';
html += '×”×¡×›×•× ××—×•×©×‘ ×™×—×¡×™ ×œ××¡×¤×¨ ×—×•×“×©×™ ×”×¢×‘×•×“×”.<br>';
html += '×œ×“×•×’××”:<br>';
html += 'â€¢ 12 ×—×•×“×©×™× â†’ ' + formatNumber(TAKROT_2025.amitMutavShanati) + ' â‚ª<br>';
html += 'â€¢ 9 ×—×•×“×©×™× â†’ ' + formatNumber((TAKROT_2025.amitMutavShanati / 12) * 9) + ' â‚ª<br>';
html += 'â€¢ 6 ×—×•×“×©×™× â†’ ' + formatNumber((TAKROT_2025.amitMutavShanati / 12) * 6) + ' â‚ª<br><br>';
html += '</div>';
html += '</div>';

            if (data.age >= 50) {
                html += '<div class="explanation" style="background: #f3e5f5; border-color: #9c27b0; margin-top: 15px;">';
                html += '<div class="explanation-title" style="color: #6a1b9a;">ğŸ‚ ×”×˜×‘×” ××™×•×—×“×ª ×œ×’×™×œ 50+</div>';
                html += '<div class="explanation-text" style="color: #6a1b9a;">';
                html += '×›×™×•×•×Ÿ ×©××ª/×” ××¢×œ ×’×™×œ 50, ××ª/×” ×–×›××™/×ª ×œ×©×™×¢×•×¨ × ×™×›×•×™ ××•×’×“×œ!<br><br>';
                html += 'â€¢ ×¢×“ ×’×™×œ 50: 11% × ×™×›×•×™<br>';
                html += 'â€¢ ××¢×œ ×’×™×œ 50: <strong>16.5%</strong> × ×™×›×•×™ (×ª×•×¡×¤×ª ×©×œ 50%)<br><br>';
                html += 'âš ï¸ <strong>××‘×œ ×©×™×/×™ ×œ×‘:</strong> ×”×”×˜×‘×” ×”×–×• ×¨×œ×•×•× ×˜×™×ª ×¨×§ ×× ×”×©×›×¨ ×”××‘×•×˜×— ×©×œ×š × ××•×š ×-' + formatNumber(TAKROT_2025.shacharMevutachMaxLeSe47) + ' â‚ª ×œ×—×•×“×©.';
                html += '</div>';
                html += '</div>';
            }

            // ××–×•×¨ ×¢×“×›×•×Ÿ ×ª×§×¨×•×ª
            html += '<div class="result-box" style="background: #f5f5f5; border: 2px dashed #999;">';
            html += '<div class="result-title" style="color: #666;">âš™ï¸ ×ª×§×¨×•×ª ×©× ×ª 2025 (×œ×¢×“×›×•×Ÿ)</div>';
            html += '<div style="font-size: 13px; color: #666; line-height: 1.8;">';
         html += '<strong>ğŸ“Œ ×¡×£ ×¢××™×ª ××•×˜×‘ (×¡×¢×™×£ 47(×)(7)):</strong><br>';
html += '&nbsp;&nbsp;&nbsp;' + formatNumber(TAKROT_2025.amitMutavShanati) + ' â‚ª/×©× ×” (16% ××”×©×›×¨ ×”×××•×¦×¢ ×‘××©×§)<br>';
html += '&nbsp;&nbsp;&nbsp;××§×•×¨: ×”×©×›×¨ ×”×××•×¦×¢: 13,316 â‚ª Ã— 12 Ã— 16%<br><br>';
            html += 'ğŸ“Œ <strong>×”×›× ×¡×” ××–×›×” ×œ×¤×™ ×¡×¢×™×£ 47 (×)(1)</strong> '+formatNumber(TAKROT_2025.hachnasaMezaka) + ' â‚ª/×—×•×“×©<br>';
            html += 'ğŸ“Œ <strong>×¡×›×•× ×”×©×•×•×” ×œ×©×ª×™ ×¤×¢××™× ×•×—×¦×™ ×”×¡×›×•× ×”×××•×¨ ×‘×¤×¡×§×” (1) ×œ×”×’×“×¨×” "×”×›× ×¡×” ××–×›×”" ×œ×©× ×” -×ª×§×¨×ª ×”×›× ×¡×” ×œ× ×™×›×•×™ ×œ×¤×™ ×¡×¢×™×£ 47:</strong> ' + formatNumber(TAKROT_2025.shacharMevutachMaxLeSe47) + ' â‚ª/×—×•×“×©<br>';
            html += 'ğŸ“Œ <strong>×œ×¢× ×™×Ÿ ×¢××™×ª ××•×˜×‘ ×©×œ× ×”×™×ª×” ×œ×• ×‘×©× ×ª ×”××¡ ×”×›× ×¡×” ××‘×•×˜×—×ª â€“ 5% ××”×›× ×¡×ª×• ×”×—×™×™×‘×ª ×¢×“ ×œ×¡×›×•× ×”×©×•×•×” ×œ×¤×¢××™×™× ×”×¡×›×•× ×”×××•×¨ ×‘×¤×¡×§×” (1) ×œ×”×’×“×¨×” "×”×›× ×¡×” ××–×›×”" ×©×‘×¡×¢×™×£ 47(×)(1) ×œ×©× ×”-×ª×§×¨×ª ×–×™×›×•×™ ×¢××™×ª ××•×˜×‘:</strong> ' + formatNumber(TAKROT_2025.zikuiMaxAmitMutav) + ' â‚ª<br>';
            html += 'ğŸ“Œ <strong>×ª×§×¨×ª ×–×™×›×•×™ ×œ× ×¢××™×ª ××•×˜×‘:</strong> ' + formatNumber(TAKROT_2025.zikuiMaxLoMutav) + ' â‚ª<br>';
            html += 'ğŸ“Œ <strong>×ª×§×¨×ª × ×™×›×•×™ ××§×¡×™××œ×™×ª:</strong> ' + formatNumber(TAKROT_2025.nikuiMax) + ' â‚ª<br>';
            html += 'ğŸ“Œ <strong>×”×›× ×¡×” ××–×›×” ×¡×¢×™×£ 47:</strong> ' + formatNumber(TAKROT_2025.haknasaMezakeSe47) + ' â‚ª<br><br>';
            
            html += '</div>';
            html += '</div>';

            // ×”×¦×”×¨×ª ××—×¨×™×•×ª
            html += '<div class="warning-box" style="margin-top: 30px;">';
            html += '<div class="warning-title">âš ï¸ ×”×¦×”×¨×ª ××—×¨×™×•×ª</div>';
            html += '<div class="warning-text">';
            html += '××—×©×‘×•×Ÿ ×–×” ××¡×¤×§ ××•××“×Ÿ ×›×œ×œ×™ ×‘×œ×‘×“ ×•××™× ×• ××”×•×•×” ×™×™×¢×•×¥ ××¡ ××• ×¤× ×¡×™×•× ×™. ×”×ª×•×¦××•×ª ××‘×•×¡×¡×•×ª ×¢×œ ×¤×§×•×“×ª ××¡ ×”×›× ×¡×” ×•×ª×§× ×•×ª×™×” ×”×™×“×•×¢×•×ª ×œ×©× ×ª 2025, ××š:<br><br>';
            html += 'â€¢ ×”×ª×§×¨×•×ª ×•×”×¡×›×•××™× ×¢×©×•×™×™× ×œ×”×©×ª× ×•×ª ×‘××”×œ×š ×”×©× ×”<br>';
            html += 'â€¢ ××¦×‘×™× ××™×©×™×™× ××™×•×—×“×™× ×¢×©×•×™×™× ×œ×”×©×¤×™×¢ ×¢×œ ×”×—×™×©×•×‘<br>';
            html += 'â€¢ ××•××œ×¥ ×œ×”×ª×™×™×¢×¥ ×¢× ×™×•×¢×¥ ××¡ ××• ×™×•×¢×¥ ×¤× ×¡×™×•× ×™ ××•×¡××š<br>';
            html += 'â€¢ ×”××™×“×¢ × ×›×•×Ÿ ×œ××•×¢×“ ×™×¦×™×¨×ª ×”××—×©×‘×•×Ÿ (2025)<br><br>';
            html += '<strong>××™×Ÿ ×œ×¨××•×ª ×‘××™×“×¢ ×–×” ×ª×—×œ×™×£ ×œ×™×™×¢×•×¥ ××§×¦×•×¢×™!</strong>';
            html += '</div>';
            html += '</div>';

            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            
            // ×’×œ×™×œ×” ×œ×ª×•×¦××•×ª
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // ×”×•×¡×¤×ª ×¤×•× ×§×¦×™×•× ×œ×™×•×ª Enter
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        calculate();
                    }
                });
            });
        });
    </script>
</body>
</html>
